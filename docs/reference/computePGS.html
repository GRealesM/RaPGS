<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute PGS from GWAS summary statistics using posteriors from Wakefield's approximate Bayes Factors — computePGS • RápidoPGS</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute PGS from GWAS summary statistics using posteriors from Wakefield's approximate Bayes Factors — computePGS" />
<meta property="og:description" content="'computePGS computes PGS from a from GWAS summary statistics using posteriors from Wakefield's approximate Bayes Factors" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RápidoPGS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Computing_RapidoPGS.html">Computing a PGS using RápidoPGS and GWAS catalog</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute PGS from GWAS summary statistics using posteriors from Wakefield's approximate Bayes Factors</h1>
    
    <div class="hidden name"><code>computePGS.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>'<code>computePGS</code> computes PGS from a from GWAS summary statistics using posteriors from Wakefield's approximate Bayes Factors</p>
    </div>

    <pre class="usage"><span class='fu'>computePGS</span>(
  <span class='no'>data</span>,
  <span class='no'>N0</span>,
  <span class='kw'>N1</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>build</span> <span class='kw'>=</span> <span class='st'>"hg19"</span>,
  <span class='kw'>pi_i</span> <span class='kw'>=</span> <span class='fl'>1e-04</span>,
  <span class='kw'>sd.prior</span> <span class='kw'>=</span> <span class='kw'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span>(<span class='no'>N1</span>)) {     <span class='fl'>0.15</span> } <span class='kw'>else</span> {     <span class='fl'>0.2</span> },
  <span class='kw'>log.p</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>filt_threshold</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>recalc</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>reference</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>forsAUC</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>altformat</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>a data.table containing GWAS summary statistic dataset
with all required information.</p></td>
    </tr>
    <tr>
      <th>N0</th>
      <td><p>a scalar representing the number of controls in the
study (or the number of subjects in quantitative trait GWAS),
or a string indicating the column name containing it.</p></td>
    </tr>
    <tr>
      <th>N1</th>
      <td><p>a scalar representing the number of cases in the
case-control study, or a string indicating the column name containing it.
If NULL (DEFAULT), quantitative trait will be assumed.</p></td>
    </tr>
    <tr>
      <th>build</th>
      <td><p>a string containing the genome build of the dataset,
either "hg19" (for hg19/GRCh37) or "hg38" (hg38/GRCh38). DEFAULT
"hg19".</p></td>
    </tr>
    <tr>
      <th>pi_i</th>
      <td><p>a scalar representing the prior probability (DEFAULT:
\(1 \times 10^{-4}\)).</p></td>
    </tr>
    <tr>
      <th>sd.prior</th>
      <td><p>the prior specifies that BETA at causal SNPs
follows a centred normal distribution with standard deviation
sd.prior. Sensible and widely used DEFAULTs are 0.2 for case
control traits, and 0.15 * var(trait) for quantitative (selected
if N1 is NULL).</p></td>
    </tr>
    <tr>
      <th>log.p</th>
      <td><p>if FALSE (DEFAULT), p is a p value. If TRUE, p is a
log(p) value. Use this if your dataset holds p values too small
to be accurately stored without using logs.</p></td>
    </tr>
    <tr>
      <th>filt_threshold</th>
      <td><p>a scalar indicating the ppi threshold (if
<code>filt_threshold</code> &lt; 1) or the number of top SNPs by absolute
weights (if <code>filt_threshold</code> &gt;= 1) to filter the dataset
after PGS computation. If NULL (DEFAULT), no thresholding will
be applied.</p></td>
    </tr>
    <tr>
      <th>recalc</th>
      <td><p>a logical indicating if weights should be
recalculated after thresholding. Only relevant if <code>filt_threshold</code>
is defined.</p></td>
    </tr>
    <tr>
      <th>reference</th>
      <td><p>a string indicating the path of the reference file
SNPs should be filtered and aligned to, see Details.</p></td>
    </tr>
    <tr>
      <th>forsAUC</th>
      <td><p>a logical indicating if output should be in sAUC
evaluation format as we used it for the paper.</p></td>
    </tr>
    <tr>
      <th>altformat</th>
      <td><p>a logical indicating if output should be in a
format containing pid (chr:pos), ALT, and weights only. DEFAULT
FALSE</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a data.table containing the formatted sumstats dataset with
computed PGS weights.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Main RápidoPGS function. This function will take a GWAS summary statistic dataset as an input,
will assign align it to a reference panel file (if provided), then it will assign
SNPs to LD blocks and compute Wakefield's ppi by LD block, then will use it
to generate PGS weights by multiplying those posteriors by effect sizes (\(\beta\)).
Optionally, it will filter SNPs by a custom filter on ppi and then recalculate weights, to improve accuracy.</p>
<p>Alternatively, if filt_threshold is larger than one, RápidoPGS will select the top
<code>filt_threshold</code> SNPs by absolute weights (note, not ppi but weights).</p>
<p>The GWAS summary statistics file to compute PGS using our method must contain the following minimum columns, with these exact column names:</p><dl'>
<dt>CHR</dt><dd><p>Chromosome</p></dd>
<dt>BP</dt><dd><p>Base position (in GRCh37/hg19 or GRCh38/hg38). If using hg38, use build = "hg38" in parameters</p></dd>
<dt>SNPID</dt><dd><p>rsids, or SNP identifiers. If not available, they can be anything (eg. CHR_BP)</p></dd>
<dt>REF</dt><dd><p>Reference, or non-effect allele</p></dd>
<dt>ALT</dt><dd><p>Alternative, or effect allele, the one \(\beta\) refers to</p></dd>
<dt>ALT_FREQ</dt><dd><p>Minor/ALT allele frequency in the tested population, or in a close population from a reference panel</p></dd>
<dt>BETA</dt><dd><p>\(\beta\) (or log(OR)), or effect sizes</p></dd>
<dt>SE</dt><dd><p>standard error of \(\beta\)</p></dd>
<dt>P</dt><dd><p>P-value for the association test</p></dd>

</dl>

<p>If a reference is provided. It should have 5 columns: CHR, BP,
SNPID, REF, and ALT. Also, it should be in the same build as
the summary statistics. In both files, column order does not matter.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Guillermo Reales, Chris Wallace.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


